<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>分配任务负责人 | Sugar</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="Sugar">
    
    <link rel="preload" href="/assets/css/0.styles.e8e4f3a3.css" as="style"><link rel="preload" href="/assets/js/app.69b68c9a.js" as="script"><link rel="preload" href="/assets/js/2.c3162e30.js" as="script"><link rel="preload" href="/assets/js/11.32883836.js" as="script"><link rel="prefetch" href="/assets/js/10.67b9b5e3.js"><link rel="prefetch" href="/assets/js/12.96849b7a.js"><link rel="prefetch" href="/assets/js/13.2fef4b4b.js"><link rel="prefetch" href="/assets/js/14.1d691475.js"><link rel="prefetch" href="/assets/js/15.3e0491eb.js"><link rel="prefetch" href="/assets/js/16.d5abc5db.js"><link rel="prefetch" href="/assets/js/17.5c1823ae.js"><link rel="prefetch" href="/assets/js/18.3e2d936c.js"><link rel="prefetch" href="/assets/js/19.1b5f733f.js"><link rel="prefetch" href="/assets/js/20.78316f77.js"><link rel="prefetch" href="/assets/js/21.353c4514.js"><link rel="prefetch" href="/assets/js/22.5f92fa4d.js"><link rel="prefetch" href="/assets/js/23.59276304.js"><link rel="prefetch" href="/assets/js/24.b447b33d.js"><link rel="prefetch" href="/assets/js/25.3f2a92eb.js"><link rel="prefetch" href="/assets/js/26.d250c5c2.js"><link rel="prefetch" href="/assets/js/27.38884266.js"><link rel="prefetch" href="/assets/js/28.73269734.js"><link rel="prefetch" href="/assets/js/29.d65c78d6.js"><link rel="prefetch" href="/assets/js/3.b6c170f4.js"><link rel="prefetch" href="/assets/js/30.1e414ba1.js"><link rel="prefetch" href="/assets/js/31.dea786d9.js"><link rel="prefetch" href="/assets/js/32.c9e2a998.js"><link rel="prefetch" href="/assets/js/33.aaddc02a.js"><link rel="prefetch" href="/assets/js/34.d6f907ca.js"><link rel="prefetch" href="/assets/js/35.5edb0d10.js"><link rel="prefetch" href="/assets/js/36.5030a651.js"><link rel="prefetch" href="/assets/js/37.726ca940.js"><link rel="prefetch" href="/assets/js/38.3da9a950.js"><link rel="prefetch" href="/assets/js/39.e4de6c7f.js"><link rel="prefetch" href="/assets/js/4.354831d7.js"><link rel="prefetch" href="/assets/js/40.b7df088d.js"><link rel="prefetch" href="/assets/js/41.6b81d841.js"><link rel="prefetch" href="/assets/js/42.f17107af.js"><link rel="prefetch" href="/assets/js/43.2c58b279.js"><link rel="prefetch" href="/assets/js/44.161badac.js"><link rel="prefetch" href="/assets/js/45.de1985a4.js"><link rel="prefetch" href="/assets/js/46.d2f40e6b.js"><link rel="prefetch" href="/assets/js/47.1bbc8b9d.js"><link rel="prefetch" href="/assets/js/48.21d73da1.js"><link rel="prefetch" href="/assets/js/49.75c0b4a5.js"><link rel="prefetch" href="/assets/js/5.23e5bbd6.js"><link rel="prefetch" href="/assets/js/50.e19bba92.js"><link rel="prefetch" href="/assets/js/51.1bfaeeb7.js"><link rel="prefetch" href="/assets/js/52.cf9c08e6.js"><link rel="prefetch" href="/assets/js/53.98f68fc2.js"><link rel="prefetch" href="/assets/js/54.78c99b06.js"><link rel="prefetch" href="/assets/js/55.97c03d70.js"><link rel="prefetch" href="/assets/js/56.072d42ac.js"><link rel="prefetch" href="/assets/js/57.8a5e3912.js"><link rel="prefetch" href="/assets/js/58.76261948.js"><link rel="prefetch" href="/assets/js/59.2f651211.js"><link rel="prefetch" href="/assets/js/6.7cf8d3f8.js"><link rel="prefetch" href="/assets/js/60.28b3955f.js"><link rel="prefetch" href="/assets/js/61.d087e753.js"><link rel="prefetch" href="/assets/js/62.36545f6c.js"><link rel="prefetch" href="/assets/js/63.28c54ec4.js"><link rel="prefetch" href="/assets/js/64.a4af0af7.js"><link rel="prefetch" href="/assets/js/65.ce8babdc.js"><link rel="prefetch" href="/assets/js/66.44b13a09.js"><link rel="prefetch" href="/assets/js/67.cee6d91c.js"><link rel="prefetch" href="/assets/js/68.ef899144.js"><link rel="prefetch" href="/assets/js/69.ae6aed4e.js"><link rel="prefetch" href="/assets/js/7.85c6be04.js"><link rel="prefetch" href="/assets/js/70.f59539a5.js"><link rel="prefetch" href="/assets/js/71.b74df555.js"><link rel="prefetch" href="/assets/js/72.f0adf094.js"><link rel="prefetch" href="/assets/js/73.62d12699.js"><link rel="prefetch" href="/assets/js/74.98a44d1b.js"><link rel="prefetch" href="/assets/js/8.378f6b79.js"><link rel="prefetch" href="/assets/js/9.340596c0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e8e4f3a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Sugar</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/数据库/ElasticSearch/ES知识体系.html" class="nav-link">
  Flutter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          SQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/数据库/MySQL/MySQL目录结构.html" class="nav-link">
  MySQL
</a></li></ul></li><li class="dropdown-item"><h4>
          NoSQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/数据库/ElasticSearch/ES知识体系.html" class="nav-link">
  ElasticSearch
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  MangoDB
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          后端框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  MyBatis
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/SpEL&amp;EL表达式.html" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-subitem"><a href="/框架/Activiti/Activiti介绍.html" class="nav-link">
  Activiti
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          服务器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-subitem"><a href="/中间件/Tomcat/" class="nav-link">
  Tomcat
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Netty
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Nacos
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  OSS
</a></li></ul></li><li class="dropdown-item"><h4>
          消息队列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Kafka
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  架构
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><span class="title">运维</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维" class="mobile-dropdown-title"><span class="title">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/运维/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  K8S
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  DevOps
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  监控
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  日志收集
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/数据库/ElasticSearch/ES知识体系.html" class="nav-link">
  Flutter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          SQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/数据库/MySQL/MySQL目录结构.html" class="nav-link">
  MySQL
</a></li></ul></li><li class="dropdown-item"><h4>
          NoSQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/数据库/ElasticSearch/ES知识体系.html" class="nav-link">
  ElasticSearch
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  MangoDB
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          后端框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  MyBatis
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/SpEL&amp;EL表达式.html" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-subitem"><a href="/框架/Activiti/Activiti介绍.html" class="nav-link">
  Activiti
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          服务器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-subitem"><a href="/中间件/Tomcat/" class="nav-link">
  Tomcat
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Netty
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Nacos
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  OSS
</a></li></ul></li><li class="dropdown-item"><h4>
          消息队列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-subitem"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Kafka
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  架构
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><span class="title">运维</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维" class="mobile-dropdown-title"><span class="title">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/运维/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  K8S
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  DevOps
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  监控
</a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/Activiti/.html" class="nav-link">
  日志收集
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Activiti</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/框架/Activiti/Activiti介绍.html" class="sidebar-link">Activiti介绍</a></li><li><a href="/框架/Activiti/Activiti环境.html" class="sidebar-link">Activiti环境</a></li><li><a href="/框架/Activiti/Activiti类关系图.html" class="sidebar-link">Activiti类关系图</a></li><li><a href="/框架/Activiti/Activiti入门.html" class="sidebar-link">Activiti入门</a></li><li><a href="/框架/Activiti/Activiti流程操作.html" class="sidebar-link">Activiti流程操作</a></li><li><a href="/框架/Activiti/Activiti流程实例.html" class="sidebar-link">Activiti流程实例</a></li><li><a href="/框架/Activiti/Activiti个人任务.html" class="active sidebar-link">Activiti个人任务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/框架/Activiti/Activiti个人任务.html#分配任务负责人" class="sidebar-link">分配任务负责人</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/框架/Activiti/Activiti个人任务.html#固定分配" class="sidebar-link">固定分配</a></li><li class="sidebar-sub-header"><a href="/框架/Activiti/Activiti个人任务.html#表达式分配" class="sidebar-link">表达式分配</a></li></ul></li><li class="sidebar-sub-header"><a href="/框架/Activiti/Activiti个人任务.html#查询任务" class="sidebar-link">查询任务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/框架/Activiti/Activiti个人任务.html#查询任务负责人的待办任务" class="sidebar-link">查询任务负责人的待办任务</a></li><li class="sidebar-sub-header"><a href="/框架/Activiti/Activiti个人任务.html#businesskey" class="sidebar-link">businessKey</a></li></ul></li><li class="sidebar-sub-header"><a href="/框架/Activiti/Activiti个人任务.html#办理任务" class="sidebar-link">办理任务</a></li></ul></li><li><a href="/框架/Activiti/Activiti流程变量.html" class="sidebar-link">Activiti流程变量</a></li><li><a href="/框架/Activiti/Activiti组任务.html" class="sidebar-link">Activiti组任务</a></li><li><a href="/框架/Activiti/Activiti网关.html" class="sidebar-link">Activiti网关</a></li><li><a href="/框架/Activiti/Activiti与Spring整合开发.html" class="sidebar-link">Activiti与Spring整合开发</a></li><li><a href="/框架/Activiti/Activiti7与Spring整合开发.html" class="sidebar-link">Activiti7与Spring整合开发</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="分配任务负责人"><a href="#分配任务负责人" class="header-anchor">#</a> 分配任务负责人</h2> <h3 id="固定分配"><a href="#固定分配" class="header-anchor">#</a> 固定分配</h3> <p>在进行业务流程建模时指定固定的任务负责人， 如图：</p> <p><img src="/assets/img/1575121491752.0a101a09.png" alt="1575121491752"></p> <p>并在 properties 视图中，填写 Assignee 项为任务负责人。</p> <h3 id="表达式分配"><a href="#表达式分配" class="header-anchor">#</a> 表达式分配</h3> <p>由于固定分配方式，任务只管一步一步执行任务，执行到每一个任务将按照 bpmn 的配置去分配任
务负责人。</p> <p><strong>UEL 表达式</strong></p> <p>Activiti 使用 UEL 表达式， UEL 是 java EE6 规范的一部分， UEL（Unified Expression Language）即 统一表达式语言， activiti 支持两个 UEL 表达式： UEL-value 和 UEL-method。</p> <p><strong>UEL-value 定义</strong></p> <p>如图：</p> <p><img src="/assets/img/1577503716131.9523fa16.png" alt="1577503716131"></p> <p>assignee 这个变量是 activiti 的一个流程变量，</p> <p>或者使用这种方式定义：</p> <p>如图：</p> <p><img src="/assets/img/1577503804336.7587012d.png" alt="1577503804336"></p> <p>user 也是 activiti 的一个流程变量， user.assignee 表示通过调用 user 的 getter 方法获取值。</p> <p><strong>UEL-method 方式</strong></p> <p>如图：</p> <p><img src="/assets/img/1585972081.61077b0c.png" alt=""></p> <p>userBean 是 spring 容器中的一个 bean，表示调用该 bean 的 getUserId()方法。</p> <p><strong>UEL-method 与 UEL-value 结合</strong></p> <p>再比如：
${ldapService.findManagerForEmployee(emp)}
ldapService 是 spring 容器的一个 bean，findManagerForEmployee 是该 bean 的一个方法，emp 是 activiti
流程变量， emp 作为参数传到 ldapService.findManagerForEmployee 方法中。</p> <p><strong>其它</strong></p> <p>表达式支持解析基础类型、 bean、 list、 array 和 map，也可作为条件判断。
如下：
${order.price &gt; 100 &amp;&amp; order.price &lt; 250}</p> <p><strong>编写代码配置负责人</strong></p> <ol><li>定义任务分配流程变量</li></ol> <p>如图：</p> <p><img src="/assets/img/1577503716131.9523fa16.png" alt="1577503716131"></p> <ol start="2"><li>设置流程变量</li></ol> <p>在启动流程实例时设置流程变量，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token comment">/**
     * 设置流程负责人
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">assigneeUEL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">//      获取流程引擎</span>
        <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        获取 RuntimeService</span>
        <span class="token class-name">RuntimeService</span> runtimeService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getRuntimeService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        设置assignee的取值，用户可以在界面上设置流程的执行</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> assigneeMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        assigneeMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;assignee0&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        assigneeMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;assignee1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;李经理&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        assigneeMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;assignee2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;王总经理&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        assigneeMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;assignee3&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;赵财务&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        启动流程实例，同时还要设置流程定义的assignee的值</span>
        runtimeService<span class="token punctuation">.</span><span class="token function">startProcessInstanceByKey</span><span class="token punctuation">(</span><span class="token string">&quot;myEvection1&quot;</span><span class="token punctuation">,</span>assigneeMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//       输出</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>processEngine<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>执行成功后，可以在act_ru_variable表中看到刚才map中的数据</p> <p><img src="/assets/img/1585562066-1585562152652.a8b5c2d8.png" alt=""></p> <ol start="3"><li>注意事项</li></ol> <p>由于使用了表达式分配，必须保证在任务执行过程表达式执行成功，比如：
某个任务使用了表达式${order.price &gt; 100 &amp;&amp; order.price &lt; 250}，当执行该任务时必须保证 order 在
流程变量中存在，否则 activiti 异常。</p> <p><strong>监听器分配</strong></p> <p>可以使用监听器来完成很多Activiti流程的业务。</p> <p>在本章我们使用监听器的方式来指定负责人，那么在流程设计时就不需要指定assignee。</p> <p>任务监听器是发生对应的任务相关事件时执行自定义 java 逻辑 或表达式。
任务相当事件包括：</p> <p><img src="data:image/png;base64,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" alt="1577506842889"></p> <p>Event的选项包含：</p> <div class="language- extra-class"><pre class="language-text"><code>Create：任务创建后触发
Assignment：任务分配后触发
Delete：任务完成后触发
All：所有事件发生都触发
</code></pre></div><p>定义任务监听类，且类必须实现 org.activiti.engine.delegate.TaskListener 接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTaskListener</span> <span class="token keyword">implements</span> <span class="token class-name">TaskListener</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notify</span><span class="token punctuation">(</span><span class="token class-name">DelegateTask</span> delegateTask<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>delegateTask<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;创建出差申请&quot;</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>
                delegateTask<span class="token punctuation">.</span><span class="token function">getEventName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;create&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//这里指定任务负责人</span>
            delegateTask<span class="token punctuation">.</span><span class="token function">setAssignee</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre></div><p>DelegateTask对象的内容如下：</p> <p><img src="/assets/img/1585561653.89c89baa.png" alt=""></p> <div class="custom-block warning"><p class="custom-block-title">注意事项</p> <p>使用监听器分配方式，按照监听事件去执行监听类的 notify 方法，方法如果不能正常执行也会影响
任务的执行。</p></div> <h2 id="查询任务"><a href="#查询任务" class="header-anchor">#</a> 查询任务</h2> <h3 id="查询任务负责人的待办任务"><a href="#查询任务负责人的待办任务" class="header-anchor">#</a> 查询任务负责人的待办任务</h3> <p>代码如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 查询当前个人待执行的任务</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findPersonalTaskList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 流程定义key</span>
    <span class="token class-name">String</span> processDefinitionKey <span class="token operator">=</span> <span class="token string">&quot;myEvection1&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// 任务负责人</span>
    <span class="token class-name">String</span> assignee <span class="token operator">=</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取TaskService</span>
    <span class="token class-name">TaskService</span> taskService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getTaskService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> taskList <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    	<span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span>processDefinitionKey<span class="token punctuation">)</span>
    	<span class="token punctuation">.</span><span class="token function">includeProcessVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">taskAssignee</span><span class="token punctuation">(</span>assignee<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Task</span> task <span class="token operator">:</span> taskList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;----------------------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;流程实例id： &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getProcessInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;任务id： &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;任务负责人： &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getAssignee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;任务名称： &quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="businesskey"><a href="#businesskey" class="header-anchor">#</a> businessKey</h3> <p>需求：
在 activiti 实际应用时，查询待办任务可能要显示出业务系统的一些相关信息。</p> <p>比如：查询待审批出差任务列表需要将出差单的日期、 出差天数等信息显示出来。</p> <p>出差天数等信息在业务系统中存在，而并没有在 activiti 数据库中存在，所以是无法通过 activiti 的 api 查询到出差天数等信息。
实现：
在查询待办任务时，通过 businessKey（业务标识 ）关联查询业务系统的出差单表，查询出出差天数等信息。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findProcessInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">//        获取processEngine</span>
        <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        获取TaskService</span>
        <span class="token class-name">TaskService</span> taskService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getTaskService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        获取RuntimeService</span>
        <span class="token class-name">RuntimeService</span> runtimeService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getRuntimeService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        查询流程定义的对象</span>
        <span class="token class-name">Task</span> task <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">processDefinitionKey</span><span class="token punctuation">(</span><span class="token string">&quot;myEvection1&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">taskAssignee</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        使用task对象获取实例id</span>
        <span class="token class-name">String</span> processInstanceId <span class="token operator">=</span> task<span class="token punctuation">.</span><span class="token function">getProcessInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//          使用实例id，获取流程实例对象</span>
        <span class="token class-name">ProcessInstance</span> processInstance <span class="token operator">=</span> runtimeService<span class="token punctuation">.</span><span class="token function">createProcessInstanceQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span>processInstanceId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        使用processInstance，得到 businessKey</span>
        <span class="token class-name">String</span> businessKey <span class="token operator">=</span> processInstance<span class="token punctuation">.</span><span class="token function">getBusinessKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;businessKey==&quot;</span><span class="token operator">+</span>businessKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre></div><h2 id="办理任务"><a href="#办理任务" class="header-anchor">#</a> 办理任务</h2> <p>在实际应用中，完成任务前需要校验任务的负责人是否具有该任务的办理权限 。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
     * 完成任务，判断当前用户是否有权限
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">completTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//任务id</span>
        <span class="token class-name">String</span> taskId <span class="token operator">=</span> <span class="token string">&quot;15005&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//        任务负责人</span>
        <span class="token class-name">String</span> assingee <span class="token operator">=</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//获取processEngine</span>
        <span class="token class-name">ProcessEngine</span> processEngine <span class="token operator">=</span> <span class="token class-name">ProcessEngines</span><span class="token punctuation">.</span><span class="token function">getDefaultProcessEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 创建TaskService</span>
        <span class="token class-name">TaskService</span> taskService <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getTaskService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        完成任务前，需要校验该负责人可以完成当前任务</span>
<span class="token comment">//        校验方法：</span>
<span class="token comment">//        根据任务id和任务负责人查询当前任务，如果查到该用户有权限，就完成</span>
        <span class="token class-name">Task</span> task <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">taskId</span><span class="token punctuation">(</span>taskId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">taskAssignee</span><span class="token punctuation">(</span>assingee<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>task <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            taskService<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;完成任务&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/框架/Activiti/Activiti流程实例.html" class="prev">
        Activiti流程实例
      </a></span> <span class="next"><a href="/框架/Activiti/Activiti流程变量.html">
        Activiti流程变量
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.69b68c9a.js" defer></script><script src="/assets/js/2.c3162e30.js" defer></script><script src="/assets/js/11.32883836.js" defer></script>
  </body>
</html>
