(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{240:function(t,s,a){t.exports=a.p+"assets/img/1575121491752.0a101a09.png"},256:function(t,s,a){t.exports=a.p+"assets/img/1577503716131.9523fa16.png"},294:function(t,s,a){t.exports=a.p+"assets/img/1577503804336.7587012d.png"},295:function(t,s,a){t.exports=a.p+"assets/img/1585972081.61077b0c.png"},296:function(t,s,a){t.exports=a.p+"assets/img/1585562066-1585562152652.a8b5c2d8.png"},297:function(t,s){t.exports="data:image/png;base64,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"},298:function(t,s,a){t.exports=a.p+"assets/img/1585561653.89c89baa.png"},448:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"分配任务负责人"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分配任务负责人"}},[t._v("#")]),t._v(" 分配任务负责人")]),t._v(" "),s("h3",{attrs:{id:"固定分配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#固定分配"}},[t._v("#")]),t._v(" 固定分配")]),t._v(" "),s("p",[t._v("在进行业务流程建模时指定固定的任务负责人， 如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(240),alt:"1575121491752"}})]),t._v(" "),s("p",[t._v("并在 properties 视图中，填写 Assignee 项为任务负责人。")]),t._v(" "),s("h3",{attrs:{id:"表达式分配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#表达式分配"}},[t._v("#")]),t._v(" 表达式分配")]),t._v(" "),s("p",[t._v("由于固定分配方式，任务只管一步一步执行任务，执行到每一个任务将按照 bpmn 的配置去分配任\n务负责人。")]),t._v(" "),s("p",[s("strong",[t._v("UEL 表达式")])]),t._v(" "),s("p",[t._v("Activiti 使用 UEL 表达式， UEL 是 java EE6 规范的一部分， UEL（Unified Expression Language）即 统一表达式语言， activiti 支持两个 UEL 表达式： UEL-value 和 UEL-method。")]),t._v(" "),s("p",[s("strong",[t._v("UEL-value 定义")])]),t._v(" "),s("p",[t._v("如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(256),alt:"1577503716131"}})]),t._v(" "),s("p",[t._v("assignee 这个变量是 activiti 的一个流程变量，")]),t._v(" "),s("p",[t._v("或者使用这种方式定义：")]),t._v(" "),s("p",[t._v("如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(294),alt:"1577503804336"}})]),t._v(" "),s("p",[t._v("user 也是 activiti 的一个流程变量， user.assignee 表示通过调用 user 的 getter 方法获取值。")]),t._v(" "),s("p",[s("strong",[t._v("UEL-method 方式")])]),t._v(" "),s("p",[t._v("如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(295),alt:""}})]),t._v(" "),s("p",[t._v("userBean 是 spring 容器中的一个 bean，表示调用该 bean 的 getUserId()方法。")]),t._v(" "),s("p",[s("strong",[t._v("UEL-method 与 UEL-value 结合")])]),t._v(" "),s("p",[t._v("再比如：\n${ldapService.findManagerForEmployee(emp)}\nldapService 是 spring 容器的一个 bean，findManagerForEmployee 是该 bean 的一个方法，emp 是 activiti\n流程变量， emp 作为参数传到 ldapService.findManagerForEmployee 方法中。")]),t._v(" "),s("p",[s("strong",[t._v("其它")])]),t._v(" "),s("p",[t._v("表达式支持解析基础类型、 bean、 list、 array 和 map，也可作为条件判断。\n如下：\n${order.price > 100 && order.price < 250}")]),t._v(" "),s("p",[s("strong",[t._v("编写代码配置负责人")])]),t._v(" "),s("ol",[s("li",[t._v("定义任务分配流程变量")])]),t._v(" "),s("p",[t._v("如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(256),alt:"1577503716131"}})]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("设置流程变量")])]),t._v(" "),s("p",[t._v("在启动流程实例时设置流程变量，如下：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 设置流程负责人\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("assigneeUEL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      获取流程引擎")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProcessEngine")]),t._v(" processEngine "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProcessEngines")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDefaultProcessEngine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        获取 RuntimeService")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RuntimeService")]),t._v(" runtimeService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" processEngine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRuntimeService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        设置assignee的取值，用户可以在界面上设置流程的执行")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" assigneeMap "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HashMap")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        assigneeMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"assignee0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"张三"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        assigneeMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"assignee1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"李经理"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        assigneeMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"assignee2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"王总经理"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        assigneeMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"assignee3"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"赵财务"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        启动流程实例，同时还要设置流程定义的assignee的值")]),t._v("\n        runtimeService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startProcessInstanceByKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myEvection1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("assigneeMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//       输出")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("processEngine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("执行成功后，可以在act_ru_variable表中看到刚才map中的数据")]),t._v(" "),s("p",[s("img",{attrs:{src:a(296),alt:""}})]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("注意事项")])]),t._v(" "),s("p",[t._v("由于使用了表达式分配，必须保证在任务执行过程表达式执行成功，比如：\n某个任务使用了表达式${order.price > 100 && order.price < 250}，当执行该任务时必须保证 order 在\n流程变量中存在，否则 activiti 异常。")]),t._v(" "),s("p",[s("strong",[t._v("监听器分配")])]),t._v(" "),s("p",[t._v("可以使用监听器来完成很多Activiti流程的业务。")]),t._v(" "),s("p",[t._v("在本章我们使用监听器的方式来指定负责人，那么在流程设计时就不需要指定assignee。")]),t._v(" "),s("p",[t._v("任务监听器是发生对应的任务相关事件时执行自定义 java 逻辑 或表达式。\n任务相当事件包括：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(297),alt:"1577506842889"}})]),t._v(" "),s("p",[t._v("Event的选项包含：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Create：任务创建后触发\nAssignment：任务分配后触发\nDelete：任务完成后触发\nAll：所有事件发生都触发\n")])])]),s("p",[t._v("定义任务监听类，且类必须实现 org.activiti.engine.delegate.TaskListener 接口")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyTaskListener")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskListener")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("notify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DelegateTask")]),t._v(" delegateTask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delegateTask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"创建出差申请"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n                delegateTask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEventName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"create"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这里指定任务负责人")]),t._v("\n            delegateTask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAssignee")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"张三"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])]),s("p",[t._v("DelegateTask对象的内容如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(298),alt:""}})]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意事项")]),t._v(" "),s("p",[t._v("使用监听器分配方式，按照监听事件去执行监听类的 notify 方法，方法如果不能正常执行也会影响\n任务的执行。")])]),t._v(" "),s("h2",{attrs:{id:"查询任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查询任务"}},[t._v("#")]),t._v(" 查询任务")]),t._v(" "),s("h3",{attrs:{id:"查询任务负责人的待办任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查询任务负责人的待办任务"}},[t._v("#")]),t._v(" 查询任务负责人的待办任务")]),t._v(" "),s("p",[t._v("代码如下：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查询当前个人待执行的任务")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findPersonalTaskList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 流程定义key")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" processDefinitionKey "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myEvection1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 任务负责人")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" assignee "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"张三"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取TaskService")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskService")]),t._v(" taskService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" processEngine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTaskService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Task")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" taskList "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" taskService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createTaskQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("processDefinitionKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("processDefinitionKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeProcessVariables")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("taskAssignee")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("assignee"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Task")]),t._v(" task "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" taskList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"----------------------------"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"流程实例id： "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProcessInstanceId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"任务id： "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"任务负责人： "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAssignee")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"任务名称： "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"businesskey"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#businesskey"}},[t._v("#")]),t._v(" businessKey")]),t._v(" "),s("p",[t._v("需求：\n在 activiti 实际应用时，查询待办任务可能要显示出业务系统的一些相关信息。")]),t._v(" "),s("p",[t._v("比如：查询待审批出差任务列表需要将出差单的日期、 出差天数等信息显示出来。")]),t._v(" "),s("p",[t._v("出差天数等信息在业务系统中存在，而并没有在 activiti 数据库中存在，所以是无法通过 activiti 的 api 查询到出差天数等信息。\n实现：\n在查询待办任务时，通过 businessKey（业务标识 ）关联查询业务系统的出差单表，查询出出差天数等信息。")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findProcessInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        获取processEngine")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProcessEngine")]),t._v(" processEngine "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProcessEngines")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDefaultProcessEngine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        获取TaskService")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskService")]),t._v(" taskService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" processEngine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTaskService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        获取RuntimeService")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RuntimeService")]),t._v(" runtimeService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" processEngine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRuntimeService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        查询流程定义的对象")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Task")]),t._v(" task "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" taskService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createTaskQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("processDefinitionKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myEvection1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("taskAssignee")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"张三"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("singleResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        使用task对象获取实例id")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" processInstanceId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProcessInstanceId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//          使用实例id，获取流程实例对象")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProcessInstance")]),t._v(" processInstance "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" runtimeService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createProcessInstanceQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("processInstanceId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("processInstanceId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("singleResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        使用processInstance，得到 businessKey")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" businessKey "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" processInstance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBusinessKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"businessKey=="')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("businessKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"办理任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#办理任务"}},[t._v("#")]),t._v(" 办理任务")]),t._v(" "),s("p",[t._v("在实际应用中，完成任务前需要校验任务的负责人是否具有该任务的办理权限 。")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 完成任务，判断当前用户是否有权限\n     */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("completTask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//任务id")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" taskId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"15005"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        任务负责人")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" assingee "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"张三"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获取processEngine")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProcessEngine")]),t._v(" processEngine "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProcessEngines")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDefaultProcessEngine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建TaskService")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskService")]),t._v(" taskService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" processEngine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTaskService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        完成任务前，需要校验该负责人可以完成当前任务")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        校验方法：")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        根据任务id和任务负责人查询当前任务，如果查到该用户有权限，就完成")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Task")]),t._v(" task "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" taskService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createTaskQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("taskId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("taskId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("taskAssignee")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("assingee"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("singleResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("task "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            taskService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("complete")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("taskId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"完成任务"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);