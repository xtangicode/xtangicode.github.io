(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{426:function(t,a,s){t.exports=s.p+"assets/img/nginx01.ef96fa1c.jpg"},512:function(t,a,s){"use strict";s.r(a);var n=s(14),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"安装方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装方式"}},[t._v("#")]),t._v(" 安装方式")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("rpm安装")])]),t._v(" "),a("li",[a("p",[t._v("yum安装")])]),t._v(" "),a("li",[a("p",[t._v("源码安装")])]),t._v(" "),a("li",[a("p",[t._v("docker安装")])])]),t._v(" "),a("h2",{attrs:{id:"环境安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境安装"}},[t._v("#")]),t._v(" 环境安装")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("yum install -y gcc")])]),t._v(" "),a("li",[a("p",[t._v("yum install -y pcre pcre-devel")])]),t._v(" "),a("li",[a("p",[t._v("yum install -y zlib zlib-devel")])]),t._v(" "),a("li",[a("p",[t._v("yum install -yopensslopenssl-devel")])])]),t._v(" "),a("h2",{attrs:{id:"下载nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载nginx"}},[t._v("#")]),t._v(" 下载Nginx")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /opt/ ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# wget https://nginx.org/download/nginx-1.20.2.tar.gz")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"解压安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解压安装"}},[t._v("#")]),t._v(" 解压安装")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tar -zxvf nginx-1.20.2.tar.gz")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd nginx-1.20.2 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# make ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# make install")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ln -s /usr/local/nginx/sbin/nginx /usr/local/bin/nginx  #配置全局nginx ")]),t._v("\n")])])]),a("h2",{attrs:{id:"启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[t._v("#")]),t._v(" 启动")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /usr/local/nginx/sbin/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ./nginx")]),t._v("\n")])])]),a("p",[a("code",[t._v("./nginx")]),t._v(" 启动\n"),a("code",[t._v("./nginx -s stop")]),t._v(" 快速停止\n"),a("code",[t._v("./nginx -s quit")]),t._v(" 优雅关闭，在退出前完成已经接受的连接请求\n"),a("code",[t._v("./nginx -s reload")]),t._v(" 重新加载配置")]),t._v(" "),a("h2",{attrs:{id:"安装成系统服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装成系统服务"}},[t._v("#")]),t._v(" 安装成系统服务")]),t._v(" "),a("p",[a("strong",[t._v("创建服务脚本")]),t._v(" "),a("code",[t._v("vi /usr/lib/systemd/system/nginx.service")]),t._v(" "),a("strong",[t._v("服务脚本内容")])]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[t._v("[Unit]\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("Description")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("nginx - web server")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("After")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("network.target remote-fs.target nss-lookup.target")]),t._v("\n[Service]\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("Type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("forking")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("PIDFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/usr/local/nginx/logs/nginx.pid")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ExecStartPre")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/usr/local/nginx/sbin/nginx -t -c /usr/local/nginx/conf/nginx.conf")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ExecReload")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/usr/local/nginx/sbin/nginx -s reload")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ExecStop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/usr/local/nginx/sbin/nginx -s stop")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ExecQuit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/usr/local/nginx/sbin/nginx -s quit")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("PrivateTmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n[Install]\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("WantedBy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("multi-user.target")]),t._v("\n")])])]),a("p",[a("strong",[t._v("重新加载系统服务")]),t._v(" "),a("code",[t._v("systemctl daemon-reload")]),t._v(" "),a("strong",[t._v("启动服务")]),t._v(" "),a("code",[t._v("systemctl start nginx.service")]),t._v(" "),a("strong",[t._v("开机启动")]),t._v(" "),a("code",[t._v("systemctl enable nginx.service")])]),t._v(" "),a("h2",{attrs:{id:"测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[t._v("#")]),t._v(" 测试")]),t._v(" "),a("p",[t._v("浏览器输入localhost默认端口80，无法访问检查nginx是否启动成功或者端口是否开放")]),t._v(" "),a("p",[a("img",{attrs:{src:s(426),alt:""}})]),t._v(" "),a("h2",{attrs:{id:"添加nginx-http-flv-module模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加nginx-http-flv-module模块"}},[t._v("#")]),t._v(" 添加nginx-http-flv-module模块")]),t._v(" "),a("p",[t._v("举例比如安装nginx-http-flv-module，下载地址：https://github.com/winshining/nginx-http-flv-module/archive/refs/tags/v1.2.9.tar.gz\n"),a("strong",[t._v("未安装nginx")])]),t._v(" "),a("ol",[a("li",[t._v("则执行"),a("code",[t._v("./configure --add-module=../需要添加的模块目录")]),t._v("，例如："),a("code",[t._v("./configure --add-module=../nginx-http-flv-module-master")])]),t._v(" "),a("li",[t._v("执行make编译，最后make install安装")])]),t._v(" "),a("p",[a("strong",[t._v("已安装nginx")])]),t._v(" "),a("ol",[a("li",[t._v("查看nginx安装的版本及依赖信息"),a("code",[t._v("nginx -V")])])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nginx -V")]),t._v("\nnginx version: nginx/1.22.1\nbuilt by gcc "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.8")]),t._v(".5 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20150623")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Red Hat "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.8")]),t._v(".5-44"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GCC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nbuilt with OpenSSL "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v(".2k-fips  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" Jan "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),t._v("\nTLS SNI support enabled\nconfigure arguments: "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("如果本地还保留之前的安装包（源码包），则直接进入执行命令，否则下载对应的nginx。如上nginx版本1.22.1。")])]),t._v(" "),a("li",[a("p",[t._v("进入源码包，执行命令")])])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd nginx-1.22.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar nginx-1.22.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --add-module=/data/nginx-http-flv-module-master ")]),t._v("\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[t._v("编译make，编译后千万不可以执行make install，否则会将已安装的文件覆盖。")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar nginx-1.22.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# make")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar nginx-1.22.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd objs/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar nginx-1.22.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ./nginx -V")]),t._v("\nnginx version: nginx/1.15.12\nbuilt by gcc "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.8")]),t._v(".5 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20150623")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Red Hat "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.8")]),t._v(".5-44"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GCC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nbuilt with OpenSSL "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v(".2k-fips  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" Jan "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),t._v("\nTLS SNI support enabled\nconfigure arguments: "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --add-module"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/data/nginx-http-flv-module\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[t._v("替换编译好nginx包")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar nginx-1.22.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp /usr/local/nginx/sbin/nginx /usr/local/nginx/sbin/nginx.bak #备份")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar nginx-1.22.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp -f objs/nginx /usr/local/nginx/sbin/nginx")]),t._v("\ncp: overwrite ‘/usr/sbin/nginx’? y\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar nginx-1.22.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /usr/local/nginx/sbin/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检查一下编译时间，是否替换成功")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@localhost sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ll")]),t._v("\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7956")]),t._v("\n-rwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8144792")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":45 nginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nginx软路由配置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@localhost sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rm -rf /usr/local/bin/nginx ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@localhost sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ln -s /usr/local/nginx/sbin/nginx /usr/local/bin/nginx")]),t._v("\n\n")])])]),a("ol",{attrs:{start:"6"}},[a("li",[t._v("查询依赖，检查是否安装完成")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@txSugar nginx-1.22.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nginx -V")]),t._v("\nnginx version: nginx/1.22.1\nbuilt by gcc "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.8")]),t._v(".5 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20150623")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Red Hat "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.8")]),t._v(".5-44"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GCC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nbuilt with OpenSSL "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v(".2k-fips  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" Jan "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),t._v("\nTLS SNI support enabled\nconfigure arguments: "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --add-module"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/opt/nginx-http-flv-module-1.2.9\n")])])]),a("ol",{attrs:{start:"7"}},[a("li",[t._v("配置nginx.conf")])]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("events")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    worker_connections")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" 1024;")]),t._v("\n}\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("rtmp")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{  ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    server")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{  ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1935;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        chunk_size")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("4000;  ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        application")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("liveTest { ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            live")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("on;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("\t\t\tgop_cache")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("on;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        }")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    }")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" ")]),t._v("\n}\n\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("      mime.types;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    default_type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" application/octet-stream;")]),t._v("\n    \n    .......省略\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    server")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("      80;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        server_name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" localhost;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("    \t#charset koi8-r;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("    \t#access_log  logs/host.access.log  main;")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("        location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/ {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  html;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            index")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(" index.html index.htm;")]),t._v("\n        }\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("       location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/liveTest {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("        \t#打开HTTP播放FLV直播流功能")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            flv_live")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("on;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("            #支持Transfer-Encoding chunked方式回复")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            chunked_transfer_encoding")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("on; ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("             #添加额外的HTTP头")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("'Access-Control-Allow-Origin' '*';")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("             #添加额外的HTTP头")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("            add_header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("'Access-Control-Allow-Credentials' 'true';")]),t._v("\n        }\t\n      \n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("      .......省略")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("    ")]),t._v("\n}\n")])])]),a("ol",{attrs:{start:"8"}},[a("li",[t._v("配合ffmpeg，测试模块安装是否有效")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("ffmpeg  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-re")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" /home/dev/projects/2.mp4 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c")]),t._v(" copy "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" flv rtmp://127.0.0.1:1935/liveTest/room1\n\nffmpeg "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-re")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" rtsp://127.0.0.1:8554/video "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-rtsp_transport")]),t._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-buffer_size")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("102400")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-vcodec")]),t._v(" copy "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-an")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" flv rtmp://127.0.0.1:1935/liveTest/room1\n\nffmpeg "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-rtsp_transport")]),t._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" rtsp://admin:Admin123456@132.242.41.41:554/h264/ch1/main/av_stream "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-vcodec")]),t._v(" copy "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-an")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" flv rtmp://127.0.0.1:20935/liveTest/room1\n\n\nffmpeg "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" rtsp://admin:Admin123456@132.242.41.41:554/h264/ch1/main/av_stream "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c:v")]),t._v(" copy "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-an")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" segment "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-segment_time")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3600")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-reset_timestamps")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-strftime")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" /home/dev/tx/video/output_%Y-%m-%d_%H-%M-%S.mp4\n\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);