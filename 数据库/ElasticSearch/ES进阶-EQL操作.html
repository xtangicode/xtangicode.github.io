<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>简介 | Sugar</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="Sugar">
    
    <link rel="preload" href="/assets/css/0.styles.e8e4f3a3.css" as="style"><link rel="preload" href="/assets/js/app.540aeaec.js" as="script"><link rel="preload" href="/assets/js/2.c3162e30.js" as="script"><link rel="preload" href="/assets/js/42.61775a53.js" as="script"><link rel="prefetch" href="/assets/js/10.9e12a450.js"><link rel="prefetch" href="/assets/js/11.9a2889a3.js"><link rel="prefetch" href="/assets/js/12.331855f5.js"><link rel="prefetch" href="/assets/js/13.c0a595e0.js"><link rel="prefetch" href="/assets/js/14.71cd8cbc.js"><link rel="prefetch" href="/assets/js/15.b5799bea.js"><link rel="prefetch" href="/assets/js/16.2ca2deb5.js"><link rel="prefetch" href="/assets/js/17.19608163.js"><link rel="prefetch" href="/assets/js/18.4dc79ea4.js"><link rel="prefetch" href="/assets/js/19.3fecadec.js"><link rel="prefetch" href="/assets/js/20.071d9b83.js"><link rel="prefetch" href="/assets/js/21.353c4514.js"><link rel="prefetch" href="/assets/js/22.5f92fa4d.js"><link rel="prefetch" href="/assets/js/23.da4f507b.js"><link rel="prefetch" href="/assets/js/24.cff90518.js"><link rel="prefetch" href="/assets/js/25.c203e8fb.js"><link rel="prefetch" href="/assets/js/26.51d41395.js"><link rel="prefetch" href="/assets/js/27.0a75ba43.js"><link rel="prefetch" href="/assets/js/28.73269734.js"><link rel="prefetch" href="/assets/js/29.d65c78d6.js"><link rel="prefetch" href="/assets/js/3.b1ad3da4.js"><link rel="prefetch" href="/assets/js/30.230a8bdb.js"><link rel="prefetch" href="/assets/js/31.dea786d9.js"><link rel="prefetch" href="/assets/js/32.6321160c.js"><link rel="prefetch" href="/assets/js/33.02db866e.js"><link rel="prefetch" href="/assets/js/34.2eb6f7f1.js"><link rel="prefetch" href="/assets/js/35.4107ba8c.js"><link rel="prefetch" href="/assets/js/36.8cba08f9.js"><link rel="prefetch" href="/assets/js/37.20e0212a.js"><link rel="prefetch" href="/assets/js/38.c609627a.js"><link rel="prefetch" href="/assets/js/39.1a9aeb64.js"><link rel="prefetch" href="/assets/js/4.6b930ecf.js"><link rel="prefetch" href="/assets/js/40.026a1012.js"><link rel="prefetch" href="/assets/js/41.06893ddd.js"><link rel="prefetch" href="/assets/js/43.a42a2f61.js"><link rel="prefetch" href="/assets/js/44.d1bce4cc.js"><link rel="prefetch" href="/assets/js/45.cf75fd2f.js"><link rel="prefetch" href="/assets/js/46.dbaf81a4.js"><link rel="prefetch" href="/assets/js/47.e8e06829.js"><link rel="prefetch" href="/assets/js/48.20fd7187.js"><link rel="prefetch" href="/assets/js/49.57e01b43.js"><link rel="prefetch" href="/assets/js/5.cc709946.js"><link rel="prefetch" href="/assets/js/50.db1068e7.js"><link rel="prefetch" href="/assets/js/51.eef5740d.js"><link rel="prefetch" href="/assets/js/52.02ce20d0.js"><link rel="prefetch" href="/assets/js/53.c25129d6.js"><link rel="prefetch" href="/assets/js/54.2e6e9a45.js"><link rel="prefetch" href="/assets/js/55.a4b6f932.js"><link rel="prefetch" href="/assets/js/56.7fab891a.js"><link rel="prefetch" href="/assets/js/57.97487f10.js"><link rel="prefetch" href="/assets/js/58.5ced0303.js"><link rel="prefetch" href="/assets/js/59.792820e4.js"><link rel="prefetch" href="/assets/js/6.2473f399.js"><link rel="prefetch" href="/assets/js/60.262706a9.js"><link rel="prefetch" href="/assets/js/61.d4e2e202.js"><link rel="prefetch" href="/assets/js/62.f5b09c56.js"><link rel="prefetch" href="/assets/js/63.e1112c2c.js"><link rel="prefetch" href="/assets/js/64.fb088828.js"><link rel="prefetch" href="/assets/js/65.4d8da7f9.js"><link rel="prefetch" href="/assets/js/66.6f644173.js"><link rel="prefetch" href="/assets/js/67.c19dbcc3.js"><link rel="prefetch" href="/assets/js/68.ce487c24.js"><link rel="prefetch" href="/assets/js/69.ada4c63b.js"><link rel="prefetch" href="/assets/js/7.9358edd5.js"><link rel="prefetch" href="/assets/js/70.3a9acc1f.js"><link rel="prefetch" href="/assets/js/71.bc418a50.js"><link rel="prefetch" href="/assets/js/72.75d8d9b1.js"><link rel="prefetch" href="/assets/js/73.25fadb33.js"><link rel="prefetch" href="/assets/js/74.47de0ebc.js"><link rel="prefetch" href="/assets/js/75.9cf729b0.js"><link rel="prefetch" href="/assets/js/76.4ada3539.js"><link rel="prefetch" href="/assets/js/77.b545785a.js"><link rel="prefetch" href="/assets/js/78.ce47d46c.js"><link rel="prefetch" href="/assets/js/8.588ab7c5.js"><link rel="prefetch" href="/assets/js/9.465e7e2c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e8e4f3a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Sugar</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/数据库/ElasticSearch/ES知识体系.html" class="nav-link">
  Flutter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          SQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/数据库/MySQL/MySQL目录结构.html" class="nav-link">
  MySQL
</a></li></ul></li><li class="dropdown-item"><h4>
          NoSQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/数据库/ElasticSearch/ES知识体系.html" class="nav-link">
  ElasticSearch
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  MangoDB
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          后端框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  MyBatis
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/SpEL&amp;EL表达式.html" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-subitem"><a href="/框架/Activiti/Activiti介绍.html" class="nav-link">
  Activiti
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          服务器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-subitem"><a href="/中间件/Tomcat/" class="nav-link">
  Tomcat
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Netty
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Nacos
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  OSS
</a></li></ul></li><li class="dropdown-item"><h4>
          消息队列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Kafka
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  架构
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><span class="title">运维</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维" class="mobile-dropdown-title"><span class="title">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/运维/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  K8S
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  DevOps
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  监控
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  日志收集
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/数据库/ElasticSearch/ES知识体系.html" class="nav-link">
  Flutter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          SQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/数据库/MySQL/MySQL目录结构.html" class="nav-link">
  MySQL
</a></li></ul></li><li class="dropdown-item"><h4>
          NoSQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/数据库/ElasticSearch/ES知识体系.html" class="nav-link">
  ElasticSearch
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  MangoDB
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          后端框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  MyBatis
</a></li><li class="dropdown-subitem"><a href="/框架/Spring/SpEL&amp;EL表达式.html" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-subitem"><a href="/框架/Activiti/Activiti介绍.html" class="nav-link">
  Activiti
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          服务器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/中间件/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-subitem"><a href="/中间件/Tomcat/" class="nav-link">
  Tomcat
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Netty
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Nacos
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  OSS
</a></li></ul></li><li class="dropdown-item"><h4>
          消息队列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-subitem"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Kafka
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  架构
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><span class="title">运维</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维" class="mobile-dropdown-title"><span class="title">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/运维/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  K8S
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  DevOps
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  监控
</a></li><li class="dropdown-item"><!----> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/ElasticSearch/.html" class="nav-link">
  日志收集
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ElasticSearch</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/数据库/ElasticSearch/ES知识体系.html" class="sidebar-link">ES知识体系</a></li><li><a href="/数据库/ElasticSearch/ES基础-介绍.html" class="sidebar-link">ES基础-介绍</a></li><li><a href="/数据库/ElasticSearch/ES基础-生态和场景方案.html" class="sidebar-link">ES基础-生态和场景方案</a></li><li><a href="/数据库/ElasticSearch/ES入门-ES安装及HTTP操作.html" class="sidebar-link">ES入门-ES安装及HTTP操作</a></li><li><a href="/数据库/ElasticSearch/ES入门-文档评分机制.html" class="sidebar-link">ES入门-文档评分机制</a></li><li><a href="/数据库/ElasticSearch/ES入门-JAVA操作.html" class="sidebar-link">ES入门-JAVA操作</a></li><li><a href="/数据库/ElasticSearch/ES进阶-核心概念.html" class="sidebar-link">ES进阶-核心概念</a></li><li><a href="/数据库/ElasticSearch/ES进阶-系统架构.html" class="sidebar-link">ES进阶-系统架构</a></li><li><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html" class="active sidebar-link">ES进阶-EQL操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#基础语法" class="sidebar-link">基础语法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#数据准备" class="sidebar-link">数据准备</a></li><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#数据窗口搜索" class="sidebar-link">数据窗口搜索</a></li><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#符合统计条件的事件" class="sidebar-link">符合统计条件的事件</a></li></ul></li><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#安全检测" class="sidebar-link">安全检测</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#数据准备-2" class="sidebar-link">数据准备</a></li><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#获取-regsvr32-事件的计数" class="sidebar-link">获取 regsvr32 事件的计数</a></li><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#检查命令行参数" class="sidebar-link">检查命令行参数</a></li><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#检查恶意脚本加载" class="sidebar-link">检查恶意脚本加载</a></li><li class="sidebar-sub-header"><a href="/数据库/ElasticSearch/ES进阶-EQL操作.html#检查攻击成功可能性" class="sidebar-link">检查攻击成功可能性</a></li></ul></li></ul></li><li><a href="/数据库/ElasticSearch/ES进阶-SQL操作.html" class="sidebar-link">ES进阶-SQL操作</a></li><li><a href="/数据库/ElasticSearch/ES进阶-SQL客户端DataGrip.html" class="sidebar-link">ES进阶-SQL客户端DataGrip</a></li><li><a href="/数据库/ElasticSearch/ES进阶-自然语言处理NLP.html" class="sidebar-link">ES进阶-自然语言处理NLP</a></li><li><a href="/数据库/ElasticSearch/中文分词封装-TokenizerUtil.html" class="sidebar-link">中文分词封装-TokenizerUtil</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p><strong>EQL</strong> 的全名是 Event Query Language (EQL)。事件查询语言(EQL)是一种用于基于事件的时间序列数据《例如日志，指标和跟踪)的查询语言。在 Elastic Security 平台上，当输入右效的TOL 时，查询会在数据节点上编译，执行查询并返回结果。这“切都快速、并行地发生，让用户立即看到结果。</p> <p>EQL的优点：</p> <ul><li>EQL使你可以表达事件之间的关系，许多查询语言允许您匹配单个事件。EQL 使你可以匹配不同事件类别和时间跨度的系列事件。</li> <li>EQL学习曲线很低，EQL 语法看起来像其他常见查询语言，例如 SQL。 EQL 使你可以直观地编写和读取查询，从而可以进行快速，迭代的搜索。</li></ul> <h2 id="基础语法"><a href="#基础语法" class="header-anchor">#</a> 基础语法</h2> <h3 id="数据准备"><a href="#数据准备" class="header-anchor">#</a> 数据准备</h3> <p>要运行<strong>EQL</strong>搜索，搜索到的数据流或索引必须包含时问戳和事件类别字段。 默认情况下,<strong>EQL</strong>使用<strong>Elastic</strong>通用模式(ECS)中的<code>@timestamp</code>和<code>event.category</code>字段。<code>@timestamp</code>表示时间戳，<code>event.tategory</code>表示事件分类。</p> <p>咱们准备一些简单的数据、用于表示电商网站贞面跳转</p> <div class="language-JSON extra-class"><pre class="language-json"><code># 创建索引
PUT /gmall
# 批量增加数据
PUT _bulk
<span class="token punctuation">{</span>
  <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:00:00.00+08:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;session_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;last_page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:01:00.00+08:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;session_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;last_page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;good_list&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:05:00.00+08:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;session_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;last_page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;good_list&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:07:00.00+08:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;session_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;last_page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;order&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:08:00.00+08:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;session_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;last_page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;order&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;payment&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:08:00.00+08:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;session_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125102&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;last_page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:08:00.00+08:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;session_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125102&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;last_page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;payment&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="数据窗口搜索"><a href="#数据窗口搜索" class="header-anchor">#</a> 数据窗口搜索</h3> <p>在事件响应过程中，有很多时候，了解特定时问发生的所有事件是很有用的。使用一种名为any 的特殊事件类型，针对所有事件进行匹配，如果想要匹配特定事件，就需要指明事件分类名称</p> <div class="language-JSON extra-class"><pre class="language-json"><code>GET /gmall/_eql/search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>&quot;
    any where page.user_id == <span class="token string">&quot;1&quot;</span>
  <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>

结果<span class="token operator">:</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;is_partial&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;is_running&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">329</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;events&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ddYZqogBGr_J7SAzK16u&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:01:00.00+08:00&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_list&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;dtYZqogBGr_J7SAzK16u&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:05:00.00+08:00&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_list&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;d9YZqogBGr_J7SAzK16u&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:07:00.00+08:00&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A012511&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;order&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="符合统计条件的事件"><a href="#符合统计条件的事件" class="header-anchor">#</a> 符合统计条件的事件</h3> <div class="language-JSON extra-class"><pre class="language-json"><code>GET /gmall/_eql/search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>&quot;
    any where <span class="token boolean">true</span>
  <span class="token string">&quot;&quot;</span>&quot;
  <span class="token punctuation">,</span> <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1654056000000&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1654056005000&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

结果：
<span class="token punctuation">{</span>
  <span class="token property">&quot;is_partial&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;is_running&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;events&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;dNYZqogBGr_J7SAzK16u&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:00:00.00+08:00&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>事件序列</p> <div class="language-json extra-class"><pre class="language-json"><code># 页面先访问login，后面又访问了good_detail页面
GET /gmall/_eql/search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>&quot;
    sequence by page.session_id
      <span class="token punctuation">[</span>page where page.page_id==<span class="token string">&quot;login&quot;</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span>page where page.page_id==<span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">]</span>
  <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>

结果：
<span class="token punctuation">{</span>
  <span class="token property">&quot;is_partial&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;is_running&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sequences&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;join_keys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;events&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gtZyqogBGr_J7SAzU17O&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:00:00.00+08:00&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;hNZyqogBGr_J7SAzU17O&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:05:00.00+08:00&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_list&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="安全检测"><a href="#安全检测" class="header-anchor">#</a> 安全检测</h2> <p><strong>EQL</strong>在<strong>Elastic Securit</strong>中被广泛使用。实际应用时，我们可以使用<strong>EQL</strong>语言来进行检测安全威胁和其他可疑行为。</p> <h3 id="数据准备-2"><a href="#数据准备-2" class="header-anchor">#</a> 数据准备</h3> <p>regsvr32.exe 是一个内置的命令行实用程序，用于在 Windows 中注册.dll 库。作为本机工具，regsvr32.exe 具有受信任的状态，从而使它可以绕过大多数允许列表软件和脚本阻止程序。 有权访问用户命令行的攻击者可以使用 regsvr32.exe 通过.dll 库运行恶意脚本，即使在其他情况下也不允许这些脚本运行</p> <p>regsvr32 滥用的一种常见变体是 Squfullydoo 攻击</p> <p>在 Squfullydoo 攻击中，regsvr32.exe 命令使用 scrobj.dll 库注册并运行远程脚本</p> <p>测试数据来自 Atomic Red Team 的测试数据集，其中包括模仿 Squibledoo 攻击的事件。数据已映射到 Elastic 通用架构（ECS）字段：normalized-T1117-AtomicRed-regsvr32.json</p> <p>将文件内容导入到 ES 软件中</p> <div class="language-json extra-class"><pre class="language-json"><code># 创建索引
PUT my-eql-index
# 导入数据
POST my-eql-index/_bulk?pretty&amp;refresh
</code></pre></div><div class="language-JSON extra-class"><pre class="language-json"><code># 导入数据
GET /_cat/indices/my-eql-index?v=<span class="token boolean">true</span>&amp;h=health<span class="token punctuation">,</span>status<span class="token punctuation">,</span>index<span class="token punctuation">,</span>docs.count
</code></pre></div><h3 id="获取-regsvr32-事件的计数"><a href="#获取-regsvr32-事件的计数" class="header-anchor">#</a> 获取 regsvr32 事件的计数</h3> <div class="language-JSON extra-class"><pre class="language-json"><code># 查询数据
# ?filter_path=-hits.events 从响应中排除 hits.events 属性。 此搜索仅用于获取事件计数，
而不是匹配事件的列表
# query <span class="token operator">:</span> 匹配任何进程名称为 regsvr32.exe 的事件
# size <span class="token operator">:</span> 最多返回 <span class="token number">200</span> 个匹配事件的匹配<span class="token punctuation">,</span>实际查询结果为 <span class="token number">143</span> 个
GET my-eql-index/_eql/search?filter_path=-hits.events
<span class="token punctuation">{</span>
 <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>&quot;
 any where process.name == <span class="token string">&quot;regsvr32.exe&quot;</span> 
 <span class="token string">&quot;&quot;</span>&quot;<span class="token punctuation">,</span>
 <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">200</span> 
<span class="token punctuation">}</span>
</code></pre></div><h3 id="检查命令行参数"><a href="#检查命令行参数" class="header-anchor">#</a> 检查命令行参数</h3> <div class="language-JSON extra-class"><pre class="language-json"><code># 增加过滤条件查询数据
GET my-eql-index/_eql/search
<span class="token punctuation">{</span>
 <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>&quot;
 process where process.name == <span class="token string">&quot;regsvr32.exe&quot;</span> and 
process.command_line.keyword != <span class="token null keyword">null</span> 
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre></div><p>该查询将一个事件与创建的 event.type 相匹配，指示 regsvr32.exe 进程的开始。根据事件的 process.command_line 值，regsvr32.exe 使用 scrobj.dll 注册了脚本 RegSvr32.sct.这符合 Squibledoo 攻击的行为</p> <h3 id="检查恶意脚本加载"><a href="#检查恶意脚本加载" class="header-anchor">#</a> 检查恶意脚本加载</h3> <div class="language-JSON extra-class"><pre class="language-json"><code># 增加过滤条件查询数据
GET my-eql-index/_eql/search
<span class="token punctuation">{</span>
 <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>&quot;
 library where process.name == <span class="token string">&quot;regsvr32.exe&quot;</span> and dll.name == <span class="token string">&quot;scrobj.dll&quot;</span> 
 <span class="token string">&quot;&quot;</span>&quot; 
<span class="token punctuation">}</span>
</code></pre></div><h3 id="检查攻击成功可能性"><a href="#检查攻击成功可能性" class="header-anchor">#</a> 检查攻击成功可能性</h3> <p>在许多情况下，攻击者使用恶意脚本连接到远程服务器或下载其他文件</p> <p>使用 EQL 序列查询来检查以下一系列事件：</p> <p>（1）regsvr32.exe 进程</p> <p>（2）通过相同的进程加载 scrobj.dll 库</p> <p>（3） 同一过程中的任何网络事件</p> <p>根据上一个响应中看到的命令行值，你可以期望找到一个匹配项。但是，此查询并非针对该特定命令而设计。取而代之的是，它寻找一种可疑行为的模式，这种模式足以检测出相似的威胁</p> <div class="language-JSON extra-class"><pre class="language-json"><code># 增加过滤条件查询数据
GET my-eql-index/_eql/search
<span class="token punctuation">{</span>
 <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>&quot;
 sequence by process.pid
 <span class="token punctuation">[</span>process where process.name == <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span>library where dll.name == <span class="token string">&quot;scrobj.dll&quot;</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span>network where <span class="token boolean">true</span><span class="token punctuation">]</span> 
 <span class="token string">&quot;&quot;</span>&quot; 
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/数据库/ElasticSearch/ES进阶-系统架构.html" class="prev">
        ES进阶-系统架构
      </a></span> <span class="next"><a href="/数据库/ElasticSearch/ES进阶-SQL操作.html">
        ES进阶-SQL操作
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.540aeaec.js" defer></script><script src="/assets/js/2.c3162e30.js" defer></script><script src="/assets/js/42.61775a53.js" defer></script>
  </body>
</html>
